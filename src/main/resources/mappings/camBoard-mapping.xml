<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.earthnus.user.camBoard.CamBoardMybatis">
	
	<resultMap id="camBoardResult" type="camBoard">
		<id property="CAMB_NUM" column="CAMB_NUM"/>
		<result property="CAMB_NAME" column="CAMB_NAME"/>
		<result property="CAMB_SUBJECT" column="CAMB_SUBJECT"/>
		<result property="CAMB_CONTENT" column="CAMB_CONTENT"/>
		<result property="CAMB_FILE" column="CAMB_FILE"/>
		<result property="CAMB_DATE" column="CAMB_DATE"/>
	</resultMap>
	
	<select id="getBoardList" resultMap="camBoardResult">
			SELECT * 
			FROM CAMBOARD 
			WHERE (
			<choose>
				<when test='search_type.equals("CAMB_ENTIRE")'>
				(CAMB_NAME LIKE #{search} OR CAMB_SUBJECT LIKE #{search} OR CAMB_CONTENT LIKE #{search})
				</when>
				<when test='search_type.equals("CAMB_NAME")'>CAMB_NAME LIKE #{search} </when>
				<when test='search_type.equals("CAMB_SUBJECT")'>CAMB_SUBJECT LIKE #{search} </when>
				<when test='search_type.equals("CAMB_CONTENT")'>CAMB_CONTENT LIKE #{search} </when>
			</choose>
			AND 
			<choose>
				<when test='arr.equals("entire")'><![CDATA[(CAMB_STARTDATE>SYSDATE() OR CAMB_STARTDATE<SYSDATE())) ]]></when>
				<when test='arr.equals("doing")'><![CDATA[(CAMB_STARTDATE<SYSDATE() AND CAMB_FINDATE>SYSDATE())) ]]></when>
				<when test='arr.equals("exp")'><![CDATA[CAMB_STARTDATE>SYSDATE()) ]]></when>
				<when test='arr.equals("end")'><![CDATA[CAMB_FINDATE<SYSDATE()) ]]></when>
			</choose>
			ORDER BY ${orderBy} ${order} LIMIT #{contentnum} OFFSET #{pagenum}
	</select>
	
		<select id="getAdBoardList" resultMap="camBoardResult">
			SELECT * 
			FROM CAMBOARD 
			WHERE (
			<choose>
				<when test='search_type.equals("CAMB_ENTIRE")'>
				(CAMB_NAME LIKE #{search} OR CAMB_SUBJECT LIKE #{search} OR CAMB_CONTENT LIKE #{search})
				</when>
				<when test='search_type.equals("CAMB_NAME")'>CAMB_NAME LIKE #{search} </when>
				<when test='search_type.equals("CAMB_SUBJECT")'>CAMB_SUBJECT LIKE #{search} </when>
				<when test='search_type.equals("CAMB_CONTENT")'>CAMB_CONTENT LIKE #{search} </when>
			</choose>
			AND 
			<choose>
				<when test='arr.equals("entire")'><![CDATA[(CAMB_STARTDATE>SYSDATE() OR CAMB_STARTDATE<SYSDATE())) ]]></when>
				<when test='arr.equals("doing")'><![CDATA[(CAMB_STARTDATE<SYSDATE() AND CAMB_FINDATE>SYSDATE())) ]]></when>
				<when test='arr.equals("exp")'><![CDATA[CAMB_STARTDATE>SYSDATE()) ]]></when>
				<when test='arr.equals("end")'><![CDATA[CAMB_FINDATE<SYSDATE()) ]]></when>
			</choose>
	</select>
	
	<select id="getBoardListCount" resultType="int">
			SELECT COUNT(*) 
			FROM CAMBOARD 
			WHERE (
			<choose>
				<when test='search_type.equals("CAMB_ENTIRE")'>
				(CAMB_NAME LIKE #{search} OR CAMB_SUBJECT LIKE #{search} OR CAMB_CONTENT LIKE #{search})
				</when>
				<when test='search_type.equals("CAMB_NAME")'>CAMB_NAME LIKE #{search} </when>
				<when test='search_type.equals("CAMB_SUBJECT")'>CAMB_SUBJECT LIKE #{search} </when>
				<when test='search_type.equals("CAMB_CONTENT")'>CAMB_CONTENT LIKE #{search} </when>
			</choose>
			AND 
			<choose>
				<when test='arr.equals("entire")'><![CDATA[(CAMB_STARTDATE>SYSDATE() OR CAMB_STARTDATE<SYSDATE())) ]]></when>
				<when test='arr.equals("doing")'><![CDATA[(CAMB_STARTDATE<SYSDATE() AND CAMB_FINDATE>SYSDATE())) ]]></when>
				<when test='arr.equals("exp")'><![CDATA[CAMB_STARTDATE>SYSDATE()) ]]></when>
				<when test='arr.equals("end")'><![CDATA[CAMB_FINDATE<SYSDATE()) ]]></when>
			</choose>
	</select>
	
	<select id="getCamBoard" resultMap="camBoardResult">
		<![CDATA[
			SELECT * FROM CAMBOARD WHERE CAMB_NUM=#{contentnum}
		]]>
	</select>
	
	<update id="camBoardUpdate">
		<![CDATA[
			UPDATE CAMBOARD SET CAMB_NAME = #{CAMB_NAME}, CAMB_SUBJECT = #{CAMB_SUBJECT}, CAMB_CONTENT = #{CAMB_CONTENT}, 
			CAMB_FILE = #{CAMB_FILE}, CAMB_STARTDATE = #{CAMB_STARTDATE}, CAMB_FINDATE = #{CAMB_FINDATE} WHERE CAMB_NUM = #{CAMB_NUM}
		]]>
	</update>
	
	<insert id="camBoardInsert">
		<![CDATA[
			INSERT INTO CAMBOARD (CAMB_NAME, CAMB_SUBJECT, CAMB_CONTENT, CAMB_FILE, CAMB_STARTDATE, CAMB_FINDATE) 
			VALUES(#{CAMB_NAME}, #{CAMB_SUBJECT}, #{CAMB_CONTENT}, #{CAMB_FILE}, #{CAMB_STARTDATE}, #{CAMB_FINDATE})
		]]>
	</insert>
	
	<delete id="camBoardDelete">
		<![CDATA[
			DELETE FROM CAMBOARD WHERE CAMB_NUM = #{CAMB_NUM}
		]]>
	</delete>
</mapper>